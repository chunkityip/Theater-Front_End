import { Component, OnInit, PLATFORM_ID, Inject } from '@angular/core';
import { CommonModule, isPlatformBrowser } from '@angular/common';
import { FormsModule } from '@angular/forms';
import { Router } from '@angular/router';

interface Movie {
  id: number;
  name: string;
  time?: string;
  theater?: string;
  duration?: string;
  showDates: string[];
  imageUrl: string;
}

interface SeatState {
  status?: 'available' | 'occupied' | 'selected';
  id: string;
}

@Component({
  selector: 'app-seat-selection',
  standalone: true,
  imports: [CommonModule, FormsModule],
  templateUrl: './seat.component.html',
  styleUrls: ['./seat.component.css']
})
export class SeatSelectionComponent implements OnInit {
  selectedMovie: Movie = {
    id: 1,
    name: 'John Wick 1',
    showDates: ['11/1', '11/2', '11/3'],
    imageUrl: 'data:image/jpeg;base64,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'
  };

  seatLayout: SeatState[][] = [];
  showTimes: string[] = ['10:00am'];
  selectedDate: string = '11/1';
  selectedTime: string = '10:00am';
  private isBrowser: boolean;

  constructor(@Inject(PLATFORM_ID) platformId: Object , private router: Router) {
    this.isBrowser = isPlatformBrowser(platformId);
  }

  ngOnInit(): void {
    this.initializeSeatLayout();
    if (this.isBrowser) {
      this.loadSavedData();
    }
  }

  private initializeSeatLayout(): void {
    this.seatLayout = Array(8).fill(null).map((_, rowIndex) =>
      Array(10).fill(null).map((_, seatIndex) => ({
        status: Math.random() < 0.3 ? 'occupied' : 'available',
        id: `${this.getRowLabel(rowIndex)}${seatIndex + 1}`
      }))
    );
  }

  getRowLabel(index: number): string {
    return String.fromCharCode(65 + index);
  }

  onSeatClick(rowIndex: number, seatIndex: number): void {
    const seat = this.seatLayout[rowIndex][seatIndex];
    if (seat.status === 'occupied') return;

    seat.status = seat.status === 'selected' ? 'available' : 'selected';

    if (this.isBrowser) {
      this.saveToLocalStorage();
    }
  }

  selectDate(date: string): void {
    this.selectedDate = date;
    this.saveToLocalStorage();
  }

  selectTime(time: string): void {
    this.selectedTime = time;
    this.saveToLocalStorage();
  }

  hasSelectedSeats(): boolean {
    return this.seatLayout.some(row =>
      row.some(seat => seat.status === 'selected')
    );
  }

  continue(): void {
    const selectedSeats = this.seatLayout
      .flatMap(row => row.filter(seat => seat.status === 'selected'))
      .map(seat => seat.id);

    console.log('Selected seats:', selectedSeats);
    console.log('Selected date:', this.selectedDate);
    console.log('Selected time:', this.selectedTime);
    // Implement checkout logic here
    this.router.navigate(['/cart']);
  }

  private saveToLocalStorage(): void {
    if (!this.isBrowser) return;
    try {
      const dataToSave = {
        seatLayout: this.seatLayout,
        selectedDate: this.selectedDate,
        selectedTime: this.selectedTime
      };
      localStorage.setItem('seatSelection', JSON.stringify(dataToSave));
    } catch (error) {
      console.error('Error saving to localStorage:', error);
    }
  }

  private loadSavedData(): void {
    if (!this.isBrowser) return;
    try {
      const savedData = localStorage.getItem('seatSelection');
      if (savedData) {
        const parsed = JSON.parse(savedData);
        this.seatLayout = parsed.seatLayout;
        this.selectedDate = parsed.selectedDate;
        this.selectedTime = parsed.selectedTime;
      }
    } catch (error) {
      console.error('Error loading from localStorage:', error);
    }
  }
}

